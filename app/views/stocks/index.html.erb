<h2 class="text-2xl font-bold mb-4">Top 10 Active Stocks</h2>
<div class="grid grid-cols-5 gap-4">
  <% @stocks.each do |stock| %>
    <div class="card bg-white shadow-lg rounded-lg p-4 flex flex-col items-center justify-between">
      <%= image_tag @stock_logos[stock.symbol], alt: "#{stock.company_name} logo", class: "w-20 h-20 object-contain" %>
      <div class="text-center mt-2">
        <p class="text-lg font-semibold"><%= stock.company_name %> (<%= stock.symbol %>)</p>
        <p class="text-gray-700">Current Price: $<%= @stock_prices[stock.symbol].latest_price %></p>
      </div>
      <button onclick="openModal('<%= stock.symbol %>')" class="mt-3 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
        Buy
      </button>
    </div>

  <!-- Modal -->
<div id="modal-<%= stock.symbol %>" class="fixed hidden inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full" data-price="<%= @stock_prices[stock.symbol].latest_price %>">
  <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
    <div class="mt-3 text-center">
      <%= image_tag @stock_logos[stock.symbol], alt: "#{stock.company_name} logo", class: "mx-auto w-20 h-20 object-contain" %>
      <h3 class="text-lg leading-6 font-medium text-gray-900"><%= stock.symbol %></h3>
      <div class="mt-2 px-7 py-3">
        <input type="number" id="quantity-<%= stock.symbol %>" name="quantity" min="1" class="mt-1 block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" placeholder="Quantity" oninput="updateTotalPrice('<%= stock.symbol %>')">
        <p class="text-gray-500 mt-4">Total Price: $<span id="total-<%= stock.symbol %>">0.00</span></p>
      </div>
      <div class="items-center px-4 py-3">
        <button id="close-modal" onclick="closeModal('<%= stock.symbol %>')" class="px-4 py-2 bg-gray-500 text-white text-base font-medium rounded-md w-full shadow-sm hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-300">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

  <% end %>
</div>

<script>
  
function openModal(symbol) {
    document.getElementById('modal-' + symbol).style.display = 'block';
  }
  
  function closeModal(symbol) {
    document.getElementById('modal-' + symbol).style.display = 'none';
  }

  function updateTotalPrice(symbol) {
  const modal = document.getElementById('modal-' + symbol);
  const price = parseFloat(modal.getAttribute('data-price'));
  const quantityInput = document.getElementById('quantity-' + symbol);
  const quantity = parseInt(quantityInput.value) || 0;
  const total = price * quantity;
  document.getElementById('total-' + symbol).textContent = total.toFixed(2);
}
  
</script>